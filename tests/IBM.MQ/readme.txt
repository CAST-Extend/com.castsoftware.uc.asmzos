code taken from https://capitalware.com/mq_code_asm.html
